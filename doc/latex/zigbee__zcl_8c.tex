\hypertarget{zigbee__zcl_8c}{\section{src/zigbee/zigbee\-\_\-zcl.c File Reference}
\label{zigbee__zcl_8c}\index{src/zigbee/zigbee\-\_\-zcl.\-c@{src/zigbee/zigbee\-\_\-zcl.\-c}}
}


Process General Commands for Zig\-Bee Cluster Library and provide support functions to other layers of the stack.  


{\ttfamily \#include $<$errno.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include \char`\"{}xbee/platform.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}xbee/byteorder.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}wpan/aps.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}zigbee/zcl.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}zigbee/zcl\-\_\-types.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__zcl_ga1d1ebe413ff0242049bed47dc8ffefe9}{\#define {\bfseries zigbee\-\_\-zcl\-\_\-debug}}\label{group__zcl_ga1d1ebe413ff0242049bed47dc8ffefe9}

\item 
\hypertarget{group__zcl_ga0b1185c5098f4fa736010b594ab2b71f}{\#define {\bfseries Z\-C\-L\-\_\-\-D\-I\-S\-C\-O\-V\-E\-R\-\_\-\-A\-T\-T\-R\-I\-B\-\_\-\-M\-A\-X}~20}\label{group__zcl_ga0b1185c5098f4fa736010b594ab2b71f}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_ga947f6103f6bbe716ddeacbaed65e3ce3}{zcl\-\_\-send\-\_\-response} (\hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} $\ast$request, const void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$response, \hyperlink{group__hal_ga5a8b2dc9e45a9ee81a94ef304fb62505}{uint16\-\_\-t} \hyperlink{group__zdo_gab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Send a response to a Z\-C\-L command. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug const \\*
\hyperlink{structzcl__attribute__base__t}{zcl\-\_\-attribute\-\_\-base\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$ \hyperlink{group__zcl_ga66d9c3c646422e71fed6c94d67c14fdd}{zcl\-\_\-attribute\-\_\-get\-\_\-next} (const \hyperlink{structzcl__attribute__base__t}{zcl\-\_\-attribute\-\_\-base\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$entry)
\begin{DoxyCompactList}\small\item\em Return a pointer to the next attribute entry from an attribute table. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug const \\*
\hyperlink{structzcl__attribute__base__t}{zcl\-\_\-attribute\-\_\-base\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$ \hyperlink{group__zcl_ga00ac8dd36cad01d9479a84c296380f40}{zcl\-\_\-find\-\_\-attribute} (const \hyperlink{structzcl__attribute__base__t}{zcl\-\_\-attribute\-\_\-base\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$entry, \hyperlink{group__hal_ga5a8b2dc9e45a9ee81a94ef304fb62505}{uint16\-\_\-t} search\-\_\-id)
\begin{DoxyCompactList}\small\item\em Search the attribute table starting at {\ttfamily entry}, for attribute I\-D {\ttfamily search\-\_\-id}. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_ga592c970c1f0bda49f1c618d2895dbc6d}{zcl\-\_\-build\-\_\-header} (\hyperlink{group__zcl_gaeac1f6671916dd0ad92b271080ec272a}{zcl\-\_\-header\-\_\-response\-\_\-t} $\ast$rsp, \hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} $\ast$cmd)
\begin{DoxyCompactList}\small\item\em Support function to fill in a Z\-C\-L response header. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_gab5c99acba0d864acd326bcab46d1416e}{zcl\-\_\-default\-\_\-response} (\hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} $\ast$request, \hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\-\_\-t} \hyperlink{group__xbee__atcmd_gade818037fd6c985038ff29656089758d}{status})
\begin{DoxyCompactList}\small\item\em Send a Default Response (\hyperlink{group__zcl_ga92499f538455b8d5a525510fba54adb2}{Z\-C\-L\-\_\-\-C\-M\-D\-\_\-\-D\-E\-F\-A\-U\-L\-T\-\_\-\-R\-E\-S\-P}) to a given command. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_ga87ee4a8117e0420786a109b1f590ddc5}{zcl\-\_\-check\-\_\-minmax} (const \hyperlink{structzcl__attribute__base__t}{zcl\-\_\-attribute\-\_\-base\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$entry, const \hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$buffer\-\_\-le)
\begin{DoxyCompactList}\small\item\em Checks whether a new value from a Write Attributes command is within the limits specified for a given attribute. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_ga9f9ac99001185554fe24dc7b09c0b0b0}{zcl\-\_\-parse\-\_\-attribute\-\_\-record} (const \hyperlink{structzcl__attribute__base__t}{zcl\-\_\-attribute\-\_\-base\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$entry, \hyperlink{structzcl__attribute__write__rec__t}{zcl\-\_\-attribute\-\_\-write\-\_\-rec\-\_\-t} $\ast$write\-\_\-rec)
\begin{DoxyCompactList}\small\item\em Parse an attribute record from a Write Attributes Request or a Read Attributes Response and possibly store the new attribute value. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug \hyperlink{group__hal__dos_ga09a1e304d66d35dd47daffee9731edaa}{uint32\-\_\-t} \hyperlink{group__zcl_ga405e1c70b6278aae3a307971433c9229}{zcl\-\_\-convert\-\_\-24bit} (const void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$value\-\_\-le, \hyperlink{group__hal_ga04dd5074964518403bf944f2b240a5f8}{bool\-\_\-t} extend\-\_\-sign)
\begin{DoxyCompactList}\small\item\em Convert a 24-\/bit (3-\/byte) little-\/endian value to a 32-\/bit value in host byte order. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_ga15bf36dadccd7a045bad7d6f0842e25a}{zcl\-\_\-decode\-\_\-attribute} (const \hyperlink{structzcl__attribute__base__t}{zcl\-\_\-attribute\-\_\-base\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$entry, \hyperlink{structzcl__attribute__write__rec__t}{zcl\-\_\-attribute\-\_\-write\-\_\-rec\-\_\-t} $\ast$rec)
\begin{DoxyCompactList}\small\item\em Decode attribute value from a Write Attribute Request or Read Attribute Response record and optionally write to {\ttfamily entry}. \end{DoxyCompactList}\item 
int \hyperlink{group__zcl_gaff3abb5d2022101c2873e7a8e8b027e5}{\-\_\-zcl\-\_\-write\-\_\-attributes} (\hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} $\ast$cmd)
\begin{DoxyCompactList}\small\item\em Process the three types of Write Attributes requests. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_ga4387e5f016fb26d1ac43b24f78aa066a}{\-\_\-zcl\-\_\-encode\-\_\-struct\-\_\-value} (\hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$buffer, \hyperlink{group__hal_ga2140805d08462d474b82ddc8d1c2f3e6}{int16\-\_\-t} bufsize, const \hyperlink{structzcl__struct__t}{zcl\-\_\-struct\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$zcl\-\_\-struct)
\begin{DoxyCompactList}\small\item\em Format a Z\-C\-L struct for a Read Attributes Response or a Write Attributes Request. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_gaae79107724236347a5e22612869df2bf}{\-\_\-zcl\-\_\-encode\-\_\-array\-\_\-value} (\hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$buffer, \hyperlink{group__hal_ga2140805d08462d474b82ddc8d1c2f3e6}{int16\-\_\-t} bufsize, const \hyperlink{structzcl__array__t}{zcl\-\_\-array\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$array)
\begin{DoxyCompactList}\small\item\em Format a Z\-C\-L array for a Read Attributes Response or a Write Attributes Request. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_gae3f7f58d3b08caf95aa11f90e3995397}{zcl\-\_\-encode\-\_\-attribute\-\_\-value} (\hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$buffer, \hyperlink{group__hal_ga2140805d08462d474b82ddc8d1c2f3e6}{int16\-\_\-t} bufsize, const \hyperlink{structzcl__attribute__base__t}{zcl\-\_\-attribute\-\_\-base\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$entry)
\begin{DoxyCompactList}\small\item\em Format a Z\-C\-L attribute's value for a Read Attributes Response or a Write Attributes Request. \end{DoxyCompactList}\item 
int \hyperlink{group__zcl_gaa34c917bf05a57503e63553efcb77dc9}{\-\_\-zcl\-\_\-read\-\_\-attributes} (\hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} $\ast$cmd)
\begin{DoxyCompactList}\small\item\em Process the Read Attributes Command (\hyperlink{group__zcl_ga7a3d858b466e4202c6f2148a1b6a3eb2}{Z\-C\-L\-\_\-\-C\-M\-D\-\_\-\-R\-E\-A\-D\-\_\-\-A\-T\-T\-R\-I\-B}). \end{DoxyCompactList}\item 
int \hyperlink{group__zcl_ga385c41594437cdf661bfb518f11ee0fc}{\-\_\-zcl\-\_\-discover\-\_\-attributes} (\hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} $\ast$cmd)
\begin{DoxyCompactList}\small\item\em Process the Discover Attributes Command (\hyperlink{group__zcl_ga2919d6fc8068efac4c9969938a4b9ff5}{Z\-C\-L\-\_\-\-C\-M\-D\-\_\-\-D\-I\-S\-C\-O\-V\-E\-R\-\_\-\-A\-T\-T\-R\-I\-B}). \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_gadeb35ab493fffec9ba1c33f658929136}{zcl\-\_\-command\-\_\-build} (\hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} $\ast$cmd, const \hyperlink{structwpan__envelope__t}{wpan\-\_\-envelope\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$envelope, \hyperlink{structzcl__attribute__tree__t}{zcl\-\_\-attribute\-\_\-tree\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$tree)
\begin{DoxyCompactList}\small\item\em Parse a Z\-C\-L request and store in a \hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} structure with fields in fixed locations (therefore easier to use than the variable-\/length frame header). \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug void \hyperlink{group__zcl_gaca5c04dd787b041bf40f3b2a4463bb70}{zcl\-\_\-command\-\_\-dump} (const \hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} $\ast$cmd)
\begin{DoxyCompactList}\small\item\em Debugging routine that dumps contents of a parsed Z\-C\-L command structure to S\-T\-D\-O\-U\-T. \end{DoxyCompactList}\item 
void \hyperlink{group__zcl_ga2057f6176d44e9fad2df4f619e5777d3}{zcl\-\_\-envelope\-\_\-payload\-\_\-dump} (const \hyperlink{structwpan__envelope__t}{wpan\-\_\-envelope\-\_\-t} $\ast$envelope)
\begin{DoxyCompactList}\small\item\em Debugging routine that parses an envelope payload as a Z\-C\-L command and dumps a parsed copy to S\-T\-D\-O\-U\-T. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_ga23e4657d006b8b39ac54f0ee61786910}{zcl\-\_\-invalid\-\_\-cluster} (const \hyperlink{structwpan__envelope__t}{wpan\-\_\-envelope\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$envelope, \hyperlink{structwpan__ep__state__t}{wpan\-\_\-ep\-\_\-state\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$ep\-\_\-state)
\begin{DoxyCompactList}\small\item\em Called if a request comes in for an invalid endpoint/cluster combination. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_ga4251fbed33d85d2f7bbccb48857cae95}{zcl\-\_\-invalid\-\_\-command} (const \hyperlink{structwpan__envelope__t}{wpan\-\_\-envelope\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$envelope)
\begin{DoxyCompactList}\small\item\em Called if a request comes in for an invalid command on a valid endpoint/cluster combination. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug int \hyperlink{group__zcl_gac3849121e93e777ce9a7510d24517b9b}{zcl\-\_\-general\-\_\-command} (const \hyperlink{structwpan__envelope__t}{wpan\-\_\-envelope\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$envelope, void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$context)
\begin{DoxyCompactList}\small\item\em Handler for Z\-C\-L General Commands. \end{DoxyCompactList}\item 
zigbee\-\_\-zcl\-\_\-debug const char $\ast$ \hyperlink{group__zcl_ga04c32f1b9f6c36fae06e9bed5bd8f7dd}{zcl\-\_\-status\-\_\-text} (uint\-\_\-fast8\-\_\-t \hyperlink{group__xbee__atcmd_gade818037fd6c985038ff29656089758d}{status})
\begin{DoxyCompactList}\small\item\em Converts a Z\-C\-L status byte (one of the Z\-C\-L\-\_\-\-S\-T\-A\-T\-U\-S\-\_\-$\ast$ macros) into a string. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structzcl__attribute__tree__t}{zcl\-\_\-attribute\-\_\-tree\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} \hyperlink{group__zcl_gad1e7f7dd501a7ab02f6004e4091c6bea}{zcl\-\_\-attributes\-\_\-none} \mbox{[}1\mbox{]}
\begin{DoxyCompactList}\small\item\em If a cluster doesn't have attributes, use zcl\-\_\-attributes\-\_\-none (a single, empty attribute list) in the cluster definition. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Process General Commands for Zig\-Bee Cluster Library and provide support functions to other layers of the stack. \begin{DoxyNote}{Note}
For performance, on a low-\/resource, single-\/threaded system, the \hyperlink{structzcl__command__t}{zcl\-\_\-command\-\_\-t} object should be a global instead of building it on the stack of zcl\-\_\-general\-\_\-command and then passing a pointer around to the other functions. 
\end{DoxyNote}
