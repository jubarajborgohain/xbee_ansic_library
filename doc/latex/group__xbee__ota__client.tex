\hypertarget{group__xbee__ota__client}{\section{Client}
\label{group__xbee__ota__client}\index{Client@{Client}}
}


Code for a device to send over-\/the-\/air firmware updates to a Programmable X\-Bee.  


\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{xbee__ota__client_8c}{xbee\-\_\-ota\-\_\-client.\-c}
\begin{DoxyCompactList}\small\item\em Support code for over-\/the-\/air (O\-T\-A) firmware updates of application code on Programmable X\-Bee target. \end{DoxyCompactList}\item 
file \hyperlink{ota__client_8h}{ota\-\_\-client.\-h}
\begin{DoxyCompactList}\small\item\em Support code for over-\/the-\/air (O\-T\-A) firmware updates of application code on Programmable X\-Bee target. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t}
\begin{DoxyCompactList}\small\item\em Structure for tracking state of over-\/the-\/air update. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__xbee__ota__client_gabdc98be69226a7bbd2eb8dc231948688}{\#define {\bfseries X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-M\-A\-X\-\_\-\-A\-U\-T\-H\-\_\-\-L\-E\-N\-G\-T\-H}~64}\label{group__xbee__ota__client_gabdc98be69226a7bbd2eb8dc231948688}

\item 
\hypertarget{group__xbee__ota__client_ga2febaa0d599fc4f6fd94fbcf232f8d09}{\#define \hyperlink{group__xbee__ota__client_ga2febaa0d599fc4f6fd94fbcf232f8d09}{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-F\-L\-A\-G\-\_\-\-A\-P\-S\-\_\-\-E\-N\-C\-R\-Y\-P\-T}~0x0001}\label{group__xbee__ota__client_ga2febaa0d599fc4f6fd94fbcf232f8d09}

\begin{DoxyCompactList}\small\item\em Send data with A\-P\-S encryption. \end{DoxyCompactList}\item 
\#define \hyperlink{group__xbee__ota__client_ga35fda0f9b1d07269c75d0407f3b26425}{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-D\-A\-T\-A\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y}(ota, flags)
\begin{DoxyCompactList}\small\item\em Macro for adding the O\-T\-A receive cluster (Digi Transparent Serial) to the cluster list for W\-P\-A\-N\-\_\-\-E\-N\-D\-P\-O\-I\-N\-T\-\_\-\-D\-I\-G\-I\-\_\-\-D\-A\-T\-A. \end{DoxyCompactList}\item 
\#define {\bfseries X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-C\-M\-D\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y}(handler, context, flag)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{group__xbee__ota__client_ga8d196639e5234b3a56eb5c00ae730261}{\-\_\-xbee\-\_\-ota\-\_\-transparent\-\_\-rx} (const \hyperlink{structwpan__envelope__t}{wpan\-\_\-envelope\-\_\-t} \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$envelope, void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$context)
\begin{DoxyCompactList}\small\item\em Cluster handler for \char`\"{}\-Digi Transparent Serial\char`\"{} cluster. \end{DoxyCompactList}\item 
int \hyperlink{group__xbee__ota__client_ga1e29a78ac03e3450859847d4a5e3b73b}{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-read} (void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$context, void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$buffer, \hyperlink{group__hal_ga2140805d08462d474b82ddc8d1c2f3e6}{int16\-\_\-t} bytes)
\item 
int \hyperlink{group__xbee__ota__client_ga88905a78517417dd42f6356038717d01}{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-write} (void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$context, const void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$buffer, \hyperlink{group__hal_ga2140805d08462d474b82ddc8d1c2f3e6}{int16\-\_\-t} bytes)
\item 
int \hyperlink{group__xbee__ota__client_ga4805b029d840b86133ef62d64866c6af}{xbee\-\_\-ota\-\_\-init} (\hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t} $\ast$ota, \hyperlink{structwpan__dev__t}{wpan\-\_\-dev\-\_\-t} $\ast$dev, const \hyperlink{unionaddr64}{addr64} $\ast$target)
\begin{DoxyCompactList}\small\item\em Initialize an \hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t} structure to send firmware updates to {\ttfamily target} using {\ttfamily dev}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__xbee__ota__client_gaa7262b389539547f7405189cd4bf274c}{\hyperlink{structwpan__dev__t}{wpan\-\_\-dev\-\_\-t} $\ast$ \hyperlink{group__xbee__ota__client_gaa7262b389539547f7405189cd4bf274c}{dev}}\label{group__xbee__ota__client_gaa7262b389539547f7405189cd4bf274c}

\begin{DoxyCompactList}\small\item\em local device to send updates through \end{DoxyCompactList}\item 
\hypertarget{group__xbee__ota__client_gaef649f9dfe9109ac17db3fda73c61036}{\hyperlink{unionaddr64}{addr64} \hyperlink{group__xbee__ota__client_gaef649f9dfe9109ac17db3fda73c61036}{target}}\label{group__xbee__ota__client_gaef649f9dfe9109ac17db3fda73c61036}

\begin{DoxyCompactList}\small\item\em network device to update \end{DoxyCompactList}\item 
\hypertarget{group__xbee__ota__client_ga1e87af3c18a2fd36c61faf89949bdc3f}{\hyperlink{group__hal_ga5a8b2dc9e45a9ee81a94ef304fb62505}{uint16\-\_\-t} \hyperlink{group__xbee__ota__client_ga1e87af3c18a2fd36c61faf89949bdc3f}{flags}}\label{group__xbee__ota__client_ga1e87af3c18a2fd36c61faf89949bdc3f}

\begin{DoxyCompactList}\small\item\em combination of X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-F\-L\-A\-G\-\_\-$\ast$ values \end{DoxyCompactList}\item 
\hyperlink{structxbee__cbuf__t}{xbee\-\_\-cbuf\-\_\-t} \hyperlink{group__xbee__ota__client_gaa86751bccf68cd96c559cd1947e455c9}{cbuf}
\begin{DoxyCompactList}\small\item\em track state of circular buffer \end{DoxyCompactList}\item 
\hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\-\_\-t} \hyperlink{group__xbee__ota__client_gafaab4db801ec47fb901e28ee4c4eac04}{raw} \mbox{[}255+\hyperlink{group__util__cbuf_ga6fb73f000c9aa3d2b26f3ae089676bfa}{X\-B\-E\-E\-\_\-\-C\-B\-U\-F\-\_\-\-O\-V\-E\-R\-H\-E\-A\-D}\mbox{]}
\begin{DoxyCompactList}\small\item\em buffer for \hyperlink{structxbee__cbuf__t}{xbee\-\_\-cbuf\-\_\-t} structure and bytes received from target \end{DoxyCompactList}\item 
\hypertarget{group__xbee__ota__client_ga8a3826497465a168bcbbb5de14ea9595}{\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
union \{\\
\>\hyperlink{structxbee__cbuf__t}{xbee\_cbuf\_t} \hyperlink{group__xbee__ota__client_gaa86751bccf68cd96c559cd1947e455c9}{cbuf}\\
\>\>{\em track state of circular buffer }\\
\>\hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\_t} \hyperlink{group__xbee__ota__client_gafaab4db801ec47fb901e28ee4c4eac04}{raw} \mbox{[}255+\hyperlink{group__util__cbuf_ga6fb73f000c9aa3d2b26f3ae089676bfa}{XBEE\_CBUF\_OVERHEAD}\mbox{]}\\
\>\>{\em buffer for \hyperlink{structxbee__cbuf__t}{xbee\_cbuf\_t} structure and bytes received from target }\\
\} {\bfseries rxbuf}}\label{group__xbee__ota__client_ga8a3826497465a168bcbbb5de14ea9595}
\\

\end{tabbing}\item 
\hypertarget{group__xbee__ota__client_ga198adacee7500d0135a88d6ecc591bf5}{\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} \hyperlink{group__xbee__ota__client_ga198adacee7500d0135a88d6ecc591bf5}{xbxm}}\label{group__xbee__ota__client_ga198adacee7500d0135a88d6ecc591bf5}

\begin{DoxyCompactList}\small\item\em track state of Xmodem transfer \end{DoxyCompactList}\item 
\hypertarget{group__xbee__ota__client_ga93137186f6fec6ed6ba4db70db04ca1f}{\hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\-\_\-t} \hyperlink{group__xbee__ota__client_ga93137186f6fec6ed6ba4db70db04ca1f}{auth\-\_\-data} \mbox{[}X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-M\-A\-X\-\_\-\-A\-U\-T\-H\-\_\-\-L\-E\-N\-G\-T\-H\mbox{]}}\label{group__xbee__ota__client_ga93137186f6fec6ed6ba4db70db04ca1f}

\begin{DoxyCompactList}\small\item\em Payload used to initiate update. \end{DoxyCompactList}\item 
\hypertarget{group__xbee__ota__client_ga67b236f1ec1fbada8e400218c6e5c1f7}{\hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\-\_\-t} \hyperlink{group__xbee__ota__client_ga67b236f1ec1fbada8e400218c6e5c1f7}{auth\-\_\-length}}\label{group__xbee__ota__client_ga67b236f1ec1fbada8e400218c6e5c1f7}

\begin{DoxyCompactList}\small\item\em Number of bytes in {\ttfamily auth\-\_\-data}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Code for a device to send over-\/the-\/air firmware updates to a Programmable X\-Bee. 

\subsection{Macro Definition Documentation}
\hypertarget{group__xbee__ota__client_gada576e1f290c08c3a5ff065a4a1504cb}{\index{Client@{Client}!X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-C\-M\-D\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y@{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-C\-M\-D\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y}}
\index{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-C\-M\-D\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y@{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-C\-M\-D\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y}!Client@{Client}}
\subsubsection[{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-C\-M\-D\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-C\-M\-D\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y(
\begin{DoxyParamCaption}
\item[{}]{handler, }
\item[{}]{context, }
\item[{}]{flag}
\end{DoxyParamCaption}
)}}\label{group__xbee__ota__client_gada576e1f290c08c3a5ff065a4a1504cb}
{\bfseries Value\-:}
\begin{DoxyCode}
\{  \hyperlink{group__wpan__aps_gga1227ab13b41d82d9c9c9080662f74cf7aedb825ada66b8c7bbfbeaee6d9dfba0a}{DIGI\_CLUST\_PROG\_XBEE\_OTA\_UPD}, handler,                           
      \(\backslash\)
      context, (flag) | \hyperlink{group__wpan__aps_ga9aae0646b212af63cbb07c98a33cd986}{WPAN\_CLUST\_FLAG\_CLIENT} | 
      \hyperlink{group__wpan__aps_gacb0e365a8c5e72ee90be503513e7e630}{WPAN\_CLUST\_FLAG\_NOT\_ZCL} \}
\end{DoxyCode}
\hypertarget{group__xbee__ota__client_ga35fda0f9b1d07269c75d0407f3b26425}{\index{Client@{Client}!X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-D\-A\-T\-A\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y@{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-D\-A\-T\-A\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y}}
\index{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-D\-A\-T\-A\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y@{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-D\-A\-T\-A\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y}!Client@{Client}}
\subsubsection[{X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-D\-A\-T\-A\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-D\-A\-T\-A\-\_\-\-C\-L\-I\-E\-N\-T\-\_\-\-C\-L\-U\-S\-T\-\_\-\-E\-N\-T\-R\-Y(
\begin{DoxyParamCaption}
\item[{}]{ota, }
\item[{}]{flags}
\end{DoxyParamCaption}
)}}\label{group__xbee__ota__client_ga35fda0f9b1d07269c75d0407f3b26425}
{\bfseries Value\-:}
\begin{DoxyCode}
\{ \hyperlink{group__wpan__aps_gga1227ab13b41d82d9c9c9080662f74cf7a8208e143b452d11140e487d7d29eb38f}{DIGI\_CLUST\_SERIAL}, \hyperlink{group__xbee__ota__client_ga8d196639e5234b3a56eb5c00ae730261}{\_xbee\_ota\_transparent\_rx}
      , ota,       \(\backslash\)
      WPAN\_CLUST\_FLAG\_INOUT | \hyperlink{group__wpan__aps_gacb0e365a8c5e72ee90be503513e7e630}{WPAN\_CLUST\_FLAG\_NOT\_ZCL} | 
      flags \}
\end{DoxyCode}


Macro for adding the O\-T\-A receive cluster (Digi Transparent Serial) to the cluster list for W\-P\-A\-N\-\_\-\-E\-N\-D\-P\-O\-I\-N\-T\-\_\-\-D\-I\-G\-I\-\_\-\-D\-A\-T\-A. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ota} & pointer to an \hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t} structure for tracking update state \\
\hline
\mbox{\tt in}  & {\em flags} & additional flags for the cluster; typically 0 or \hyperlink{group__wpan__aps_ga1eafd87038a2134da7a1f72e6801d23b}{W\-P\-A\-N\-\_\-\-C\-L\-U\-S\-T\-\_\-\-F\-L\-A\-G\-\_\-\-E\-N\-C\-R\-Y\-P\-T} \\
\hline
\end{DoxyParams}


\subsection{Function Documentation}
\hypertarget{group__xbee__ota__client_ga8d196639e5234b3a56eb5c00ae730261}{\index{Client@{Client}!\-\_\-xbee\-\_\-ota\-\_\-transparent\-\_\-rx@{\-\_\-xbee\-\_\-ota\-\_\-transparent\-\_\-rx}}
\index{\-\_\-xbee\-\_\-ota\-\_\-transparent\-\_\-rx@{\-\_\-xbee\-\_\-ota\-\_\-transparent\-\_\-rx}!Client@{Client}}
\subsubsection[{\-\_\-xbee\-\_\-ota\-\_\-transparent\-\_\-rx}]{\setlength{\rightskip}{0pt plus 5cm}int \-\_\-xbee\-\_\-ota\-\_\-transparent\-\_\-rx (
\begin{DoxyParamCaption}
\item[{const {\bf wpan\-\_\-envelope\-\_\-t} {\bf F\-A\-R} $\ast$}]{envelope, }
\item[{void {\bf F\-A\-R} $\ast$}]{context}
\end{DoxyParamCaption}
)}}\label{group__xbee__ota__client_ga8d196639e5234b3a56eb5c00ae730261}


Cluster handler for \char`\"{}\-Digi Transparent Serial\char`\"{} cluster. 

Used in the cluster table of \hyperlink{group__wpan__aps_ga83cb85a2a1e374554f9ad735c9c06e7b}{W\-P\-A\-N\-\_\-\-E\-N\-D\-P\-O\-I\-N\-T\-\_\-\-D\-I\-G\-I\-\_\-\-D\-A\-T\-A} (0x\-E8) for cluster D\-I\-G\-I\-\_\-\-C\-L\-U\-S\-T\-\_\-\-S\-E\-R\-I\-A\-L (0x0011).

This is a preliminary A\-P\-I and W\-I\-L\-L change in a future release. This version is dedicated to processing responses in O\-T\-A (over-\/the-\/air) firmware updates and has not been generalized for other uses.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em envelope} & information about the frame (addresses, endpoint, profile, cluster, etc.) \\
\hline
\mbox{\tt in,out}  & {\em context} & pointer to \hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t} structure\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & handled data \\
\hline
{\em !0} & some sort of error processing data\\
\hline
\end{DoxyRetVals}
\begin{DoxySeeAlso}{See Also}
\hyperlink{group__wpan__aps_ga62b1036c0e296905f2d9a74e7e480297}{wpan\-\_\-aps\-\_\-handler\-\_\-fn()} 
\end{DoxySeeAlso}


References F\-A\-R, hex\-\_\-dump(), H\-E\-X\-\_\-\-D\-U\-M\-P\-\_\-\-F\-L\-A\-G\-\_\-\-T\-A\-B, and xbee\-\_\-cbuf\-\_\-put().

\hypertarget{group__xbee__ota__client_ga1e29a78ac03e3450859847d4a5e3b73b}{\index{Client@{Client}!\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-read@{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-read}}
\index{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-read@{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-read}!Client@{Client}}
\subsubsection[{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-read}]{\setlength{\rightskip}{0pt plus 5cm}int \-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-read (
\begin{DoxyParamCaption}
\item[{void {\bf F\-A\-R} $\ast$}]{context, }
\item[{void {\bf F\-A\-R} $\ast$}]{buffer, }
\item[{{\bf int16\-\_\-t}}]{bytes}
\end{DoxyParamCaption}
)}}\label{group__xbee__ota__client_ga1e29a78ac03e3450859847d4a5e3b73b}
Function assigned to the {\ttfamily stream.\-read} function pointer of an \hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} object. Reads data from the target specified in the \hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t} structure.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & \hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t} structure \\
\hline
\mbox{\tt in,out}  & {\em buffer} & buffer to store read data \\
\hline
\mbox{\tt in}  & {\em bytes} & maximum number of bytes to write to {\ttfamily buffer} \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{group__util__xmodem_gae8f23aee23fead01c5b812e992799ded}{xbee\-\_\-xmodem\-\_\-read\-\_\-fn()} 
\end{DoxySeeAlso}


References E\-I\-N\-V\-A\-L, F\-A\-R, and xbee\-\_\-cbuf\-\_\-get().



Referenced by xbee\-\_\-ota\-\_\-init().

\hypertarget{group__xbee__ota__client_ga88905a78517417dd42f6356038717d01}{\index{Client@{Client}!\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-write@{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-write}}
\index{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-write@{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-write}!Client@{Client}}
\subsubsection[{\-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-write}]{\setlength{\rightskip}{0pt plus 5cm}int \-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-write (
\begin{DoxyParamCaption}
\item[{void {\bf F\-A\-R} $\ast$}]{context, }
\item[{const void {\bf F\-A\-R} $\ast$}]{buffer, }
\item[{{\bf int16\-\_\-t}}]{bytes}
\end{DoxyParamCaption}
)}}\label{group__xbee__ota__client_ga88905a78517417dd42f6356038717d01}
Function assigned to the {\ttfamily stream.\-write} function pointer of an \hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} object. Sends data to the target specified in the \hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t} structure.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & \hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t} structure \\
\hline
\mbox{\tt in,out}  & {\em buffer} & source of data to send \\
\hline
\mbox{\tt in}  & {\em bytes} & number of bytes to send\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Number of bytes sent to target.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See Also}
\hyperlink{group__util__xmodem_gad858784eff97e98dff61dda16fada3b2}{xbee\-\_\-xmodem\-\_\-write\-\_\-fn()} 
\end{DoxySeeAlso}


References wpan\-\_\-envelope\-\_\-t\-::dev, E\-I\-N\-V\-A\-L, F\-A\-R, wpan\-\_\-envelope\-\_\-t\-::length, wpan\-\_\-envelope\-\_\-t\-::payload, W\-P\-A\-N\-\_\-\-C\-L\-U\-S\-T\-\_\-\-F\-L\-A\-G\-\_\-\-E\-N\-C\-R\-Y\-P\-T, wpan\-\_\-envelope\-\_\-create(), W\-P\-A\-N\-\_\-\-N\-E\-T\-\_\-\-A\-D\-D\-R\-\_\-\-U\-N\-D\-E\-F\-I\-N\-E\-D, X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-F\-L\-A\-G\-\_\-\-A\-P\-S\-\_\-\-E\-N\-C\-R\-Y\-P\-T, and xbee\-\_\-transparent\-\_\-serial().



Referenced by xbee\-\_\-ota\-\_\-init().

\hypertarget{group__xbee__ota__client_ga4805b029d840b86133ef62d64866c6af}{\index{Client@{Client}!xbee\-\_\-ota\-\_\-init@{xbee\-\_\-ota\-\_\-init}}
\index{xbee\-\_\-ota\-\_\-init@{xbee\-\_\-ota\-\_\-init}!Client@{Client}}
\subsubsection[{xbee\-\_\-ota\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int xbee\-\_\-ota\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf xbee\-\_\-ota\-\_\-t} $\ast$}]{ota, }
\item[{{\bf wpan\-\_\-dev\-\_\-t} $\ast$}]{dev, }
\item[{const {\bf addr64} $\ast$}]{target}
\end{DoxyParamCaption}
)}}\label{group__xbee__ota__client_ga4805b029d840b86133ef62d64866c6af}


Initialize an \hyperlink{structxbee__ota__t}{xbee\-\_\-ota\-\_\-t} structure to send firmware updates to {\ttfamily target} using {\ttfamily dev}. 

Calls xbee\-\_\-xmodem\-\_\-tx\-\_\-init and xbee\-\_\-xmodem\-\_\-set\-\_\-stream (therefore unnecessary to do so in main program).

Note that when performing O\-T\-A updates, you M\-U\-S\-T use X\-B\-E\-E\-\_\-\-X\-M\-O\-D\-E\-M\-\_\-\-F\-L\-A\-G\-\_\-64 (64-\/byte xmodem blocks) if calling xbee\-\_\-xmodem\-\_\-tx\-\_\-init directly.

Sends frames to the target to have it start the update cycle.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em ota} & state-\/tracking structure for sending update \\
\hline
\mbox{\tt in}  & {\em dev} & device to use for sending update \\
\hline
\mbox{\tt in}  & {\em target} & 64-\/bit address of target device\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & successfully initialized \\
\hline
{\em -\/\-E\-I\-N\-V\-A\-L} & invalid parameter passed in \\
\hline
\end{DoxyRetVals}


References \-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-read(), \-\_\-xbee\-\_\-ota\-\_\-xmodem\-\_\-write(), xbee\-\_\-ota\-\_\-t\-::auth\-\_\-data, xbee\-\_\-ota\-\_\-t\-::auth\-\_\-length, xbee\-\_\-ota\-\_\-t\-::cbuf, wpan\-\_\-envelope\-\_\-t\-::cluster\-\_\-id, wpan\-\_\-envelope\-\_\-t\-::dest\-\_\-endpoint, xbee\-\_\-ota\-\_\-t\-::dev, D\-I\-G\-I\-\_\-\-C\-L\-U\-S\-T\-\_\-\-P\-R\-O\-G\-\_\-\-X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-U\-P\-D, D\-I\-G\-I\-\_\-\-C\-L\-U\-S\-T\-\_\-\-S\-E\-R\-I\-A\-L, E\-I\-N\-V\-A\-L, xbee\-\_\-ota\-\_\-t\-::flags, wpan\-\_\-envelope\-\_\-t\-::length, wpan\-\_\-envelope\-\_\-t\-::payload, wpan\-\_\-envelope\-\_\-t\-::profile\-\_\-id, wpan\-\_\-envelope\-\_\-t\-::source\-\_\-endpoint, xbee\-\_\-ota\-\_\-t\-::target, W\-P\-A\-N\-\_\-\-C\-L\-U\-S\-T\-\_\-\-F\-L\-A\-G\-\_\-\-E\-N\-C\-R\-Y\-P\-T, W\-P\-A\-N\-\_\-\-E\-N\-D\-P\-O\-I\-N\-T\-\_\-\-D\-I\-G\-I\-\_\-\-D\-A\-T\-A, wpan\-\_\-envelope\-\_\-create(), wpan\-\_\-envelope\-\_\-send(), W\-P\-A\-N\-\_\-\-N\-E\-T\-\_\-\-A\-D\-D\-R\-\_\-\-U\-N\-D\-E\-F\-I\-N\-E\-D, W\-P\-A\-N\-\_\-\-P\-R\-O\-F\-I\-L\-E\-\_\-\-D\-I\-G\-I, xbee\-\_\-cbuf\-\_\-init(), X\-B\-E\-E\-\_\-\-O\-T\-A\-\_\-\-F\-L\-A\-G\-\_\-\-A\-P\-S\-\_\-\-E\-N\-C\-R\-Y\-P\-T, X\-B\-E\-E\-\_\-\-X\-M\-O\-D\-E\-M\-\_\-\-F\-L\-A\-G\-\_\-64, xbee\-\_\-xmodem\-\_\-set\-\_\-stream(), xbee\-\_\-xmodem\-\_\-tx\-\_\-init(), and xbee\-\_\-ota\-\_\-t\-::xbxm.

