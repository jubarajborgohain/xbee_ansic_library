\hypertarget{xbee__xmodem_8c}{\section{src/xbee/xbee\-\_\-xmodem.c File Reference}
\label{xbee__xmodem_8c}\index{src/xbee/xbee\-\_\-xmodem.\-c@{src/xbee/xbee\-\_\-xmodem.\-c}}
}


Xmodem send implementation, used for X\-Bee firmware updates.  


{\ttfamily \#include $<$stddef.\-h$>$}\\*
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include \char`\"{}xbee/platform.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}xbee/xmodem.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}xbee/xmodem\-\_\-crc16.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__util__xmodem_gae12995a59299dd50542d7a9eb6ddfd2c}{int {\bfseries \-\_\-xbee\-\_\-xmodem\-\_\-ser\-\_\-read} (void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$context, void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$buffer, \hyperlink{group__hal_ga2140805d08462d474b82ddc8d1c2f3e6}{int16\-\_\-t} bytes)}\label{group__util__xmodem_gae12995a59299dd50542d7a9eb6ddfd2c}

\item 
\hypertarget{group__util__xmodem_ga913fe444bce75fa12169083fbbf9ef03}{int {\bfseries \-\_\-xbee\-\_\-xmodem\-\_\-ser\-\_\-write} (void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$context, const void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$buffer, \hyperlink{group__hal_ga2140805d08462d474b82ddc8d1c2f3e6}{int16\-\_\-t} bytes)}\label{group__util__xmodem_ga913fe444bce75fa12169083fbbf9ef03}

\item 
\-\_\-xmodem\-\_\-debug int \hyperlink{group__util__xmodem_ga728dd61f38b5563fe2ab45bcb982a1e7}{xbee\-\_\-xmodem\-\_\-use\-\_\-serport} (\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} $\ast$xbxm, \hyperlink{structxbee__serial__t}{xbee\-\_\-serial\-\_\-t} $\ast$serport)
\begin{DoxyCompactList}\small\item\em Used for xmodem transfers over a simple serial port. \end{DoxyCompactList}\item 
\-\_\-xmodem\-\_\-debug int \hyperlink{group__util__xmodem_ga3153bea635e130326e96720fe354852d}{xbee\-\_\-xmodem\-\_\-set\-\_\-stream} (\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} $\ast$xbxm, \hyperlink{group__util__xmodem_gae8f23aee23fead01c5b812e992799ded}{xbee\-\_\-xmodem\-\_\-read\-\_\-fn} read, \hyperlink{group__util__xmodem_gad858784eff97e98dff61dda16fada3b2}{xbee\-\_\-xmodem\-\_\-write\-\_\-fn} write, const void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$context)
\begin{DoxyCompactList}\small\item\em Configure the stream used to communicate with the target. \end{DoxyCompactList}\item 
\-\_\-xmodem\-\_\-debug int \hyperlink{group__util__xmodem_gaa71f0823f6fc8db3f7c556819079b225}{xbee\-\_\-xmodem\-\_\-set\-\_\-source} (\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} $\ast$xbxm, void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$buffer, \hyperlink{group__util__xmodem_gae8f23aee23fead01c5b812e992799ded}{xbee\-\_\-xmodem\-\_\-read\-\_\-fn} read, const void \hyperlink{group__hal_gaef060b3456fdcc093a7210a762d5f2ed}{F\-A\-R} $\ast$context)
\begin{DoxyCompactList}\small\item\em Configure the data source for the Xmodem send. \end{DoxyCompactList}\item 
int \hyperlink{group__util__xmodem_gac01df75671906e590a9ed9b0a4644ba1}{\-\_\-xbee\-\_\-xmodem\-\_\-getchar} (\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} $\ast$xbxm)
\item 
int \hyperlink{group__util__xmodem_ga0cc061cd92dfa4eba4720b2839698545}{\-\_\-xbee\-\_\-xmodem\-\_\-putchar} (\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} $\ast$xbxm, \hyperlink{group__hal_gae1affc9ca37cfb624959c866a73f83c2}{uint8\-\_\-t} ch)
\item 
\-\_\-xmodem\-\_\-debug int \hyperlink{group__util__xmodem_gabc8da474bce7043eef3537bd492c5123}{xbee\-\_\-xmodem\-\_\-tx\-\_\-init} (\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} $\ast$xbxm, \hyperlink{group__hal_ga5a8b2dc9e45a9ee81a94ef304fb62505}{uint16\-\_\-t} flags)
\begin{DoxyCompactList}\small\item\em Initialize state structure for use with \hyperlink{group__util__xmodem_ga1de6d8cc3628767d877e854f92ab2b0e}{xbee\-\_\-xmodem\-\_\-tx\-\_\-tick()} to send a file via Xmodem. \end{DoxyCompactList}\item 
\hypertarget{group__util__xmodem_ga96fca6132d78345b4a3c20f89971aede}{\-\_\-xmodem\-\_\-debug int {\bfseries \-\_\-assemble\-\_\-packet} (\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} $\ast$xbxm, \hyperlink{group__hal_ga5a8b2dc9e45a9ee81a94ef304fb62505}{uint16\-\_\-t} block\-\_\-size)}\label{group__util__xmodem_ga96fca6132d78345b4a3c20f89971aede}

\item 
\hypertarget{group__util__xmodem_gab3bb5db3c60870f771cae1268fa24eb4}{\-\_\-xmodem\-\_\-debug \hyperlink{group__hal_ga5a8b2dc9e45a9ee81a94ef304fb62505}{uint16\-\_\-t} {\bfseries \-\_\-block\-\_\-size} (\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} $\ast$xbxm)}\label{group__util__xmodem_gab3bb5db3c60870f771cae1268fa24eb4}

\item 
\-\_\-xmodem\-\_\-debug int \hyperlink{group__util__xmodem_ga1de6d8cc3628767d877e854f92ab2b0e}{xbee\-\_\-xmodem\-\_\-tx\-\_\-tick} (\hyperlink{structxbee__xmodem__state__t}{xbee\-\_\-xmodem\-\_\-state\-\_\-t} $\ast$xbxm)
\begin{DoxyCompactList}\small\item\em Function to drive the Xmodem send state machine. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Xmodem send implementation, used for X\-Bee firmware updates. \begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000013}{Todo}]Have timeout values adjust based on link latency. Start out with a high timeout (10 seconds?) and adjust down based on actual response time (maybe 150\% of last A\-C\-K's delay?) Timeout for E\-O\-T should start at timeout value from last block. \end{DoxyRefDesc}
